<% content_for :title, t('.page_title') %>
<% content_for :page_header, t('.page_header') %>


<div class="row modal-body">
   <div class="page-head">
      <h1 class="page-header">
                     <i class="glyphicon glyphicon-globe"></i>

         <%= t('.page_header') %>
         <a href="/#/create_resource">
            <button ng-click="setUpdateResource('add','')" class="btn btn-primary pull-right"> <i class="fa fa-plus"></i>
               <%= t('.page_title') %></button>
       </a>
      </h1>
   </div>

   <div class="jumbotron" ng-show="intro">
        <h3><%= t('.intro_header') %></h3>
         <%= t('.intro_text') %>
   </div>

   <div ng-repeat="resource in resources" resources-repeat-directive>
      <div class="col-sm-12 col-xs-12">
        <div class="col-sm-6 col-xs-12">
          
            <h2 title="{{resource.description}}" class="pull-left">
                 {{resource.name}}
                <a href="/#/update_resource/{{resource.id}}">
                  <button class="btn btn-default btn-xs" ng-click="setUpdateResource('update',resource)"> <i class="fa fa-edit"></i>
                  </button>
                </a>
                <button class="btn btn-default btn-xs"  ng-click="removeResource(resource)">
                  <span class="glyphicon glyphicon-trash"></span>
                </button>
             </h2>
          
            <ul class="pagination pagination-sm pull-right">
              <li ><a ng-click="changePage(resource, -1)" href="">&laquo;</a></li>
              <li ng-class="{active: i==resource.page}" ng-repeat="i in getRange(resource)"><a ng-click="setEntriesForPage(i, resource)" href="">{{i}}</a></li>
              <li><a href="" ng-click="changePage(resource, 1)">&raquo;</a></li>
            </ul>
        </div>
      </div>


      <div class="col-sm-6 col-xs-12">
         <div class="adv-table editable-table">
            <table class="table table-striped table-hover table-borderless table-scrollable" id="editable-sample">
               <thead>
                  <tr>
                     <th>
                        <%= t('.date') %></th>
                     <th>
                        <%= t('.value') %></th>
                     <th>
                        <%= t('.usage') %></th>
                     <th>
                        <%= t('.costs') %></th>
                  </tr>
               </thead>
               <tbody>
                  <tr ng-repeat="entry in resource.entries" class="">
                     <td>{{entry.date | date : short}}</td>
                     <td>{{entry.value}} {{resource.unit}}</td>
                     <td>{{entry.usage}} {{resource.unit}}</td>
                     <td>
                        € {{entry.costs}}
                        <button class="btn btn-default btn-xs pull-right" ng-hide="entry.isFirst == true" ng-click="removeEntry(resource,entry)">
                           <span class="glyphicon glyphicon-trash"></span>
                        </button>
                     </td>
                  </tr>
                 
               </tbody>
            </table>
            
         </div>

         <div class="panel-footer announcement-bottom">
            <form role="form" name="Itemform" ng-submit="addEntry(resource)">
               <div class="input-group">
                <span class="input-group-addon">
                  <span class="glyphicon glyphicon-calendar"></span>
                </span>
                  <span class="input-group-btn">
                    <input ui-date="{ dateFormat: 'yy-mm-dd' }" style="width:100px" type="text" class="calendar" datepicker-popup="{{format}}" ng-model="resource.date" is-open="opened" date-disabled="disabled(date, mode)" ng-required="true" close-text="Close" />
                  </span>

                  <input type="text" class="form-control"
                      ng-model="resource.entryvalue"
                      maxlength="30"
                      placeholder="<%= t('.resourceValue') %>
                  " required>
                  <span class="input-group-btn">
                     <button class="btn btn-primary"
                        type="submit"
                        ng-disabled="!Itemform.$valid">

                        <span class="glyphicon glyphicon-plus"></span>
                        <%= t(".add") %></button>
                  </span>
               </div>
            </form>
         </div>

      </div>

   <div id="info" class="col-sm-6 hidden-xs">
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
         <ul class="nav nav-tabs">
            <li ng-class="{active: resource.showChart}"class="active">
               <a ng-click="showInfos(resource, true)" href="">
                  <%= t('.chart') %></a>
            </li>
            <li ng-class="{active: resource.showChart == false}">
               <a ng-click="showInfos(resource, false)" href="">
                  <%= t('.data') %></a>
            </li>

              
            <ul class="nav navbar-right">
                 <div ng-show="resource.showChart" >
                  <span class="glyphicon glyphicon-calendar"></span>
                  <input type="daterange"  ng-change="getChartData(resource)" ng-model="resource.chartDateRange">
               </div>


            </ul>
         </ul>
      </div>
      <!-- /.navbar-collapse -->
      <div ng-show="resource.showChart" class="">
        <div ng-show="resource.enoughEntriesForChart">
          <canvas linechart options="resource.options" data="resource.chart" width="550" height="270"></canvas>
        </div>
        <div class="col-md-offset-1" ng-hide="resource.enoughEntriesForChart">
          <div > 
            <h4><%= t('.addMoreEntriesForChart') %></h4>
          </div>
        </div>
      </div>

      <div ng-hide="resource.showChart" class="col-md-12">
          <div class="adv-table">
            <table class="table table-striped table-hover table-borderless " >
               <tbody>
                  <tr ng-repeat="info in resource.infos.general">
                     <td>{{info.name}}</td>
                     <td>{{info.usage}} {{resource.unit}}</td>
                     <td>€ {{info.costs}}</td>
                 </tr>
                     <tr ng-repeat="info in resource.infos.years">
                     <td>...{{info.name}}</td>
                     <td>{{info.usage}} {{resource.unit}}</td>
                     <td>€ {{info.costs}}</td>
                  
                  </tr>
               </tbody>
            </table>
            
         </div>
      </div>

   </div>
   <div class="col-sm-12">

      <hr></div>
</div>
</div>
